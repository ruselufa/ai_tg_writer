# üìä –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

```bash
# –ó–∞–ø—É—Å–∫–∞–µ–º –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
docker-compose up -d prometheus grafana jaeger

# –ò–ª–∏ –∑–∞–ø—É—Å–∫–∞–µ–º –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –≤–∫–ª—é—á–∞—è –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
docker-compose up -d
```

### 2. –î–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º

- **Grafana**: http://localhost:3000 (admin/admin)
- **Prometheus**: http://localhost:9090
- **Jaeger**: http://localhost:16686
- **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: http://localhost:8080
- **Health Check**: http://localhost:8080/health
- **–ú–µ—Ç—Ä–∏–∫–∏**: http://localhost:8080/metrics

## üìà –ß—Ç–æ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—Å—è

### HTTP –º–µ—Ç—Ä–∏–∫–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ –º–µ—Ç–æ–¥–∞–º –∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ (–≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞)
- –ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤

### –ë–∏–∑–Ω–µ—Å –º–µ—Ç—Ä–∏–∫–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- –í—Ä–µ–º—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ (Whisper)
- –í—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ AI (DeepSeek)
- –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- –ü–æ–¥–ø–∏—Å–∫–∏ (—Å–æ–∑–¥–∞–Ω–∏–µ, –æ—Ç–º–µ–Ω–∞, –ø—Ä–æ–¥–ª–µ–Ω–∏–µ)

### –°–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –í—ã–∑–æ–≤—ã –≤–Ω–µ—à–Ω–∏—Ö API
- Telegram —Å–æ–æ–±—â–µ–Ω–∏—è (–≤—Ö–æ–¥—è—â–∏–µ/–∏—Å—Ö–æ–¥—è—â–∏–µ)

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã (production/development)
ENV=production

# Jaeger endpoint (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
JAEGER_ENDPOINT=http://localhost:14268/api/traces
```

### Prometheus –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–§–∞–π–ª: `monitoring/prometheus.yml`

```yaml
scrape_configs:
  - job_name: 'ai_tg_writer'
    static_configs:
      - targets: ['host.docker.internal:8080']
    metrics_path: '/metrics'
    scrape_interval: 5s
```

### Grafana –¥–∞—à–±–æ—Ä–¥—ã

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑:
- `monitoring/grafana/dashboards/ai_tg_writer.json`

## üìä –î–∞—à–±–æ—Ä–¥—ã

### –û—Å–Ω–æ–≤–Ω–æ–π –¥–∞—à–±–æ—Ä–¥ "AI TG Writer Monitoring"

1. **HTTP Requests Rate** - —á–∞—Å—Ç–æ—Ç–∞ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
2. **Voice Messages Processed** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
3. **Active Users** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
4. **Voice Processing Duration** - –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

### –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –¥–∞—à–±–æ—Ä–¥–æ–≤

1. –û—Ç–∫—Ä–æ–π—Ç–µ Grafana: http://localhost:3000
2. –í–æ–π–¥–∏—Ç–µ (admin/admin)
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –¥–∞—à–±–æ—Ä–¥
4. –î–æ–±–∞–≤—å—Ç–µ –ø–∞–Ω–µ–ª–∏ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ Prometheus

## üîç –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏

–í production —Ä–µ–∂–∏–º–µ –ª–æ–≥–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ:

```json
{
  "level": "info",
  "msg": "HTTP request",
  "method": "GET",
  "path": "/ping",
  "ip": "127.0.0.1",
  "trace_id": "1234567890",
  "time": "2024-01-01T12:00:00Z"
}
```

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

- **DEBUG** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- **INFO** - –æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–±–æ—Ç–µ
- **WARN** - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- **ERROR** - –æ—à–∏–±–∫–∏
- **FATAL** - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

## üö® –ê–ª–µ—Ä—Ç—ã (–±—É–¥—É—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è)

–ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –≤ Prometheus:

```yaml
# monitoring/rules/alerts.yml
groups:
  - name: ai_tg_writer_alerts
    rules:
      - alert: HighErrorRate
        expr: rate(http_requests_total{status_code=~"5.."}[5m]) > 0.1
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "High error rate detected"
```

## üõ† –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### Prometheus –Ω–µ –≤–∏–¥–∏—Ç –º–µ—Ç—Ä–∏–∫–∏

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –Ω–∞ –ø–æ—Ä—Ç—É 8080
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç `/metrics` –¥–æ—Å—Ç—É–ø–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ `monitoring/prometheus.yml`

### Grafana –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞—à–±–æ—Ä–¥—ã

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–ø–∫–µ `monitoring/grafana/`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ provisioning –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Grafana: `docker-compose restart grafana`

### Jaeger –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç—Ä–µ–π—Å—ã

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç—Ä–µ–π—Å—ã
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Jaeger –∑–∞–ø—É—â–µ–Ω: `docker-compose ps jaeger`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ —Ç—Ä–µ–π—Å–∏–Ω–≥–∞

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker-compose logs -f ai_tg_writer

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ Prometheus
docker-compose logs -f prometheus

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ Grafana
docker-compose logs -f grafana

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose restart

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose down

# –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–û–°–¢–û–†–û–ñ–ù–û!)
docker-compose down -v
```

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose restart prometheus grafana

# –ò–ª–∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ
docker-compose down
docker-compose up -d --build
```
