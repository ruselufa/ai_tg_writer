# üéØ –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ AI TG Writer

## ‚úÖ –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ:

### üìä –ù–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
1. **–ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Telegram** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —Å–µ–π—á–∞—Å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç —Å –±–æ—Ç–æ–º
2. **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π** - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
3. **DeepSeek —Ç–æ–∫–µ–Ω—ã** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤ (input, output, total)
4. **–ü–ª–∞—Ç–µ–∂–∏** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏, —Å—É–º–º—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π
5. **–û—à–∏–±–∫–∏** - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ—à–∏–±–∫–∞–º –ø–æ —Ç–∏–ø–∞–º –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º

### üéõ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –¥–∞—à–±–æ—Ä–¥ –≤–∫–ª—é—á–∞–µ—Ç:

#### –í–µ—Ä—Ö–Ω–∏–π —Ä—è–¥:
- **HTTP Requests Rate** - —á–∞—Å—Ç–æ—Ç–∞ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- **Voice Messages Processed** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

#### –°—Ä–µ–¥–Ω–∏–π —Ä—è–¥ (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞):
- **Active Telegram Users** - –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- **Voice Messages Count** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ —á–∞—Å
- **DeepSeek Tokens Used** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã
- **Payments Success Rate** - –ø—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π

#### –ù–∏–∂–Ω–∏–π —Ä—è–¥ (–≥—Ä–∞—Ñ–∏–∫–∏):
- **Voice Processing Duration** - –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- **Payment Errors** - –æ—à–∏–±–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º
- **Payment Amount** - —Å—É–º–º—ã –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
- **API Errors** - –æ—à–∏–±–∫–∏ API –ø–æ —Ç–∏–ø–∞–º –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å:

### 1. –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
```bash
docker-compose up -d prometheus grafana jaeger
```

### 2. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
```bash
go run ./cmd/ai_tg_writer
```

### 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
```bash
go run test_metrics.go
```

## üì± –î–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º:

- **Grafana**: http://localhost:3000 (admin/admin)
- **Prometheus**: http://localhost:9090  
- **Jaeger**: http://localhost:16686
- **Health Check**: http://localhost:8080/health
- **–ú–µ—Ç—Ä–∏–∫–∏**: http://localhost:8080/metrics

## üìà –ß—Ç–æ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—Å—è:

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
- –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –¢–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π (–≥–æ–ª–æ—Å–æ–≤—ã–µ, —Ç–µ–∫—Å—Ç–æ–≤—ã–µ)
- –¢–∞—Ä–∏—Ñ—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ (—Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è)
- –°—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ (—É—Å–ø–µ—Ö/–æ—à–∏–±–∫–∞)

### DeepSeek API:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ (–≤—Ö–æ–¥–Ω—ã–µ, –≤—ã—Ö–æ–¥–Ω—ã–µ, –æ–±—â–∏–µ)
- –û—à–∏–±–∫–∏ API
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞

### –ü–ª–∞—Ç–µ–∂–∏:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
- –°—É–º–º—ã –ø–ª–∞—Ç–µ–∂–µ–π
- –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –û—à–∏–±–∫–∏ –ø–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º (YooKassa, Prodamus)

### –°–∏—Å—Ç–µ–º–∞:
- HTTP –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –í–Ω–µ—à–Ω–∏–µ API –≤—ã–∑–æ–≤—ã
- –û–±—â–∏–µ –æ—à–∏–±–∫–∏ —Å–∏—Å—Ç–µ–º—ã

## üõ† –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose restart

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down

# –û—á–∏—Å—Ç–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
rm test_metrics.go
```

## üéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

1. **–ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** - —Å—á–µ—Ç—á–∏–∫ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ —Å –±–æ—Ç–æ–º
2. **DeepSeek —Ç–æ–∫–µ–Ω—ã** - –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–ª–∏–Ω—ã —Ç–µ–∫—Å—Ç–∞
3. **–ü–ª–∞—Ç–µ–∂–∏** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤ (—Å–æ–∑–¥–∞–Ω–∏–µ, –æ–±—Ä–∞–±–æ—Ç–∫–∞, –æ—à–∏–±–∫–∏)
4. **–û—à–∏–±–∫–∏** - –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º (payment, voice, api) –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º

## üìä –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ Prometheus:

```promql
# –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
telegram_active_users

# –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∑–∞ —á–∞—Å
sum(rate(voice_messages_processed_total[1h]))

# –¢–æ–∫–µ–Ω—ã DeepSeek
sum(deepseek_tokens_used_total)

# –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –ø–ª–∞—Ç–µ–∂–µ–π
sum(rate(payments_total{status="success"}[1h])) / sum(rate(payments_total[1h])) * 100

# –û—à–∏–±–∫–∏ –ø–æ —Ç–∏–ø–∞–º
rate(errors_total[5m])
```

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéâ
