# –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Prodamus

## üöÄ –ó–∞–ø—É—Å–∫

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=your_password
DB_NAME=ai_tg_writer
PRODAMUS_SECRET_KEY=34b43ca1acbac599ac86f8b403ddede648bbe72f293fa885527c789b4aa33113
```

### 2. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
go run ./cmd/ai_tg_writer
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è:
- Telegram –±–æ—Ç –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º –ø–æ—Ä—Ç—É
- HTTP-—Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É 8080 –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

```bash
go run test_prodamus_integration.go
```

## üìã –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–æ–∫
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "üíé –ú–æ—è –ø–æ–¥–ø–∏—Å–∫–∞"
- –í—ã–±–∏—Ä–∞–µ—Ç "üí∞ –ö—É–ø–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É" 
- –ü–æ–ª—É—á–∞–µ—Ç —Å—Å—ã–ª–∫—É –Ω–∞ –æ–ø–ª–∞—Ç—É 999‚ÇΩ/–º–µ—Å—è—Ü

### ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π
- HTTP-—Å–µ—Ä–≤–µ—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤–µ–±—Ö—É–∫–∏ –æ—Ç Prodamus
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å–∏ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –û–±–Ω–æ–≤–ª—è–µ—Ç —Ç–∞—Ä–∏—Ñ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å `free` –Ω–∞ `payed`

### ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- –¢–∞–±–ª–∏—Ü–∞ `users` —Å –ø–æ–ª–µ–º `tariff`
- –¢–∞–±–ª–∏—Ü–∞ `subscriptions` –¥–ª—è –ø–æ–¥–ø–∏—Å–æ–∫
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

## üîó URL –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ Prodamus

- **–£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞**: `https://aiwhisper.ru/payment/success`
- **–ù–µ—É–¥–∞—á–Ω–∞—è –æ–ø–ª–∞—Ç–∞**: `https://aiwhisper.ru/payment/fail`  
- **–í–µ–±—Ö—É–∫–∏**: `https://aiwhisper.ru/payment/webhook`

## üõ† –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
apps/ai_tg_writer/
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îú‚îÄ‚îÄ payment_handler.go    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ server.go            # HTTP-—Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ infrastructure/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ prodamus_payments/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ prodamus_payments_handler.go  # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Prodamus
‚îÇ   ‚îî‚îÄ‚îÄ service/
‚îÇ       ‚îî‚îÄ‚îÄ subscription_service.go           # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫
‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îî‚îÄ‚îÄ 0006_add_tariff_to_users.sql        # –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î
‚îî‚îÄ‚îÄ docs/
    ‚îî‚îÄ‚îÄ PRODAMUS_INTEGRATION.md              # –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í—Å–µ –≤–µ–±—Ö—É–∫–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è HMAC-SHA256 –ø–æ–¥–ø–∏—Å—å—é
- Order ID –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ª–æ–≥–∏—Ä—É–µ—Ç:
- –°–æ–∑–¥–∞–Ω–∏–µ —Å—Å—ã–ª–æ–∫ –Ω–∞ –æ–ø–ª–∞—Ç—É
- –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–µ–±—Ö—É–∫–æ–≤ –æ—Ç Prodamus
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –û—à–∏–±–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: "–ù–µ–≤–µ—Ä–Ω–∞—è –ø–æ–¥–ø–∏—Å—å"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `PRODAMUS_SECRET_KEY` –≤ `.env`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–ª–∞—Ç–µ–∂–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞

### –ü—Ä–æ–±–ª–µ–º–∞: –í–µ–±—Ö—É–∫–∏ –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å URL –¥–ª—è –≤–µ–±—Ö—É–∫–æ–≤
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 8080

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏: `go run test_prodamus_integration.go`
3. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏: `docs/PRODAMUS_INTEGRATION.md` 